<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">è‡ªæˆ‘ä»‹ç»ç½‘ç«™</title>
    <link rel="stylesheet" href="components/style.css">
    <link rel="stylesheet" href="components/liquid-glass-block.css">
    <link rel="stylesheet" href="components/birthday.css">
    <link rel="stylesheet" href="components/splash-screen.css">
    <style>
        /* ç®¡ç†é¢æ¿æ ·å¼ */
        .management-panel {
            position: fixed;
            top: 0;
            right: -450px;
            width: 450px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            color: white;
            z-index: 10000;
            transition: right 0.3s ease;
            overflow-y: auto;
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.3);
        }
        
        .management-panel.show {
            right: 0;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .panel-header h3 {
            margin: 0;
            color: #a6deff;
            font-size: 18px;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.2s;
        }
        
        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .panel-content {
            padding: 20px;
        }
        
        .panel-section {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .panel-section h4 {
            margin: 0 0 15px 0;
            color: #a6deff;
            font-size: 16px;
            border-bottom: 1px solid rgba(166, 222, 255, 0.3);
            padding-bottom: 8px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
            font-size: 14px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            box-sizing: border-box;
            font-size: 14px;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #a6deff;
            box-shadow: 0 0 0 2px rgba(166, 222, 255, 0.2);
        }
        
        .btn {
            padding: 10px 15px;
            margin: 5px 5px 5px 0;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .btn-primary { background: #2196F3; color: white; }
        .btn-success { background: #4CAF50; color: white; }
        .btn-warning { background: #FF9800; color: white; }
        .btn-danger { background: #f44336; color: white; }
        .btn-info { background: #00BCD4; color: white; }
        
        .btn-full {
            width: 100%;
            margin: 5px 0;
        }
        
        .management-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 20px;
            cursor: pointer;
            z-index: 9999;
            transition: all 0.2s;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .management-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        .block-item {
            background: rgba(255, 255, 255, 0.08);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.2s;
        }
        
        .block-item:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.25);
        }
        
        .block-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .block-title {
            font-weight: bold;
            color: #fff;
        }
        
        .block-type {
            font-size: 12px;
            color: #aaa;
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        .block-controls {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .block-controls .btn {
            padding: 5px 10px;
            font-size: 12px;
            margin: 0;
        }
        
        .color-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .color-input-group input[type="color"] {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .color-input-group input[type="text"] {
            flex: 1;
        }
        
        .language-switcher {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 9998;
            padding: 8px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 14px;
        }
        
        .drag-handle {
            cursor: move;
            color: #aaa;
            margin-right: 10px;
        }
        
        .drag-handle:hover {
            color: #fff;
        }
        
        @media (max-width: 500px) {
            .management-panel {
                width: 100%;
                right: -100%;
            }
            
            .management-toggle {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .language-switcher {
                top: 60px;
                right: 10px;
                font-size: 12px;
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="splash-screen hidden">
        <div class="splash-content-girl">
            <div class="loader"></div>
            <p class="splash-text">åŠ è½½ä¸­...</p>
        </div>
    </div>

    <!-- Language Switcher -->
    <select id="language-switcher" class="language-switcher">
        <option value="default">é»˜è®¤æç¤º</option>
        <option value="en">English</option>
        <option value="ja">æ—¥æœ¬èª</option>
        <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
        <option value="zh-TW">ç¹é«”ä¸­æ–‡</option>
    </select>

    <!-- Management Panel -->
    <div id="management-panel" class="management-panel">
        <div class="panel-header">
            <h3>ğŸ¨ å†…å®¹ç®¡ç†ç³»ç»Ÿ</h3>
            <button id="close-panel" class="close-btn">Ã—</button>
        </div>
        <div class="panel-content">
            <!-- é¡µé¢è®¾ç½® -->
            <div class="panel-section">
                <h4>ğŸ“„ é¡µé¢è®¾ç½®</h4>
                <div class="form-group">
                    <label>é¡µé¢æ ‡é¢˜</label>
                    <input type="text" id="page-title-input" placeholder="è¯·è¾“å…¥é¡µé¢æ ‡é¢˜">
                </div>
                <div class="form-group">
                    <label>èƒŒæ™¯å›¾ç‰‡URL</label>
                    <input type="text" id="background-input" placeholder="è¯·è¾“å…¥èƒŒæ™¯å›¾ç‰‡URLæˆ–è·¯å¾„">
                </div>
            </div>
            
            <!-- å†…å®¹å—ç®¡ç† -->
            <div class="panel-section">
                <h4>ğŸ“ å†…å®¹å—ç®¡ç†</h4>
                <div class="form-group">
                    <label>å†…å®¹å—ç±»å‹</label>
                    <select id="block-type">
                        <option value="header">æ ‡é¢˜å—</option>
                        <option value="text">æ–‡æœ¬å—</option>
                        <option value="list">åˆ—è¡¨å—</option>
                        <option value="custom">è‡ªå®šä¹‰å—</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å†…å®¹å—æ ‡é¢˜</label>
                    <input type="text" id="block-title" placeholder="è¯·è¾“å…¥å†…å®¹å—æ ‡é¢˜">
                </div>
                <button class="btn btn-success btn-full" onclick="addBlock()">+ æ·»åŠ å†…å®¹å—</button>
                
                <div id="blocks-list" style="margin-top: 20px;"></div>
            </div>
            
            <!-- æ ·å¼è®¾ç½® -->
            <div class="panel-section">
                <h4>ğŸ¨ æ ·å¼è®¾ç½®</h4>
                <div class="form-group">
                    <label>ä¸»è‰²è°ƒ</label>
                    <div class="color-input-group">
                        <input type="color" id="primary-color" value="#a6deff">
                        <input type="text" id="primary-color-text" value="#a6deff">
                    </div>
                </div>
                <div class="form-group">
                    <label>é«˜äº®è‰²</label>
                    <div class="color-input-group">
                        <input type="color" id="highlight-color" value="#dbA6ff">
                        <input type="text" id="highlight-color-text" value="#dbA6ff">
                    </div>
                </div>
                <div class="form-group">
                    <label>æ–‡æœ¬è‰²</label>
                    <div class="color-input-group">
                        <input type="color" id="text-color" value="#ffa6d3">
                        <input type="text" id="text-color-text" value="#ffa6d3">
                    </div>
                </div>
            </div>
            
            <!-- é…ç½®ç®¡ç† -->
            <div class="panel-section">
                <h4>ğŸ’¾ é…ç½®ç®¡ç†</h4>
                <button class="btn btn-primary btn-full" onclick="saveConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button>
                <button class="btn btn-warning btn-full" onclick="exportConfig()">ğŸ“¤ å¯¼å‡ºé…ç½®</button>
                <button class="btn btn-info btn-full" onclick="document.getElementById('import-file').click()">ğŸ“¥ å¯¼å…¥é…ç½®</button>
                <input type="file" id="import-file" style="display: none" accept=".json" onchange="importConfig(event)">
                <button class="btn btn-danger btn-full" onclick="resetConfig()">ğŸ”„ é‡ç½®é…ç½®</button>
            </div>
        </div>
    </div>
    
    <!-- Management Toggle Button -->
    <button class="management-toggle" onclick="togglePanel()">âš™ï¸</button>
    
    <!-- Content Container -->
    <div id="content-container"></div>

    <!-- Scripts -->
    <script src="components/birthday.js"></script>
    <script src="components/splash-screen.js"></script>
    <script type="module" src="anime/sakura.js"></script>
    
    <script>
        // å…¨å±€é…ç½®å¯¹è±¡
        let config = {
            pageInfo: {
                title: "æˆ‘çš„è‡ªæˆ‘ä»‹ç»",
                language: "default"
            },
            styles: {
                backgroundImage: "components/background.jpeg",
                primaryColor: "#a6deff",
                highlightColor: "#dbA6ff",
                infoTextColor: "#ffa6d3",
                fontFamily: "KleeOne-Regular"
            },
            contentBlocks: [
                {
                    id: "header",
                    type: "header",
                    enabled: true,
                    title: "ä¸ªäººä¿¡æ¯",
                    content: {
                        greeting: "è¯·è¾“å…¥é—®å€™è¯­",
                        name: "è¯·è¾“å…¥æ‚¨çš„å§“å",
                        subtitle: "è¯·è¾“å…¥å‰¯æ ‡é¢˜"
                    },
                    styles: {
                        textAlign: "center",
                        backgroundColor: "rgba(255, 255, 255, 0.1)",
                        padding: "20px",
                        borderRadius: "24px"
                    }
                },
                {
                    id: "about",
                    type: "text",
                    enabled: true,
                    title: "ğŸŒŸ å…³äºæˆ‘",
                    content: {
                        text: "è¯·è¾“å…¥å…³äºæ‚¨çš„ä»‹ç»æ–‡æœ¬ã€‚æ‚¨å¯ä»¥åœ¨è¿™é‡Œå†™ä»»ä½•æƒ³è¦åˆ†äº«çš„å†…å®¹ã€‚"
                    },
                    styles: {
                        backgroundColor: "rgba(255, 255, 255, 0.1)",
                        padding: "20px",
                        borderRadius: "24px"
                    }
                }
            ]
        };

        // å›½é™…åŒ–æ”¯æŒ
        const i18n = {
            currentLang: 'default',
            translations: {},

            async loadTranslations(lang) {
                try {
                    const response = await fetch(`./locales/${lang}.json`);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    this.translations[lang] = await response.json();
                } catch (error) {
                    console.error(`Could not load translations for ${lang}:`, error);
                    if (lang !== 'default' && !this.translations['default']) {
                        await this.loadTranslations('default');
                    }
                }
            },

            translate(key, defaultValue = '') {
                const keys = key.split('.');
                let result = this.translations[this.currentLang];
                for (const k of keys) {
                    if (result && typeof result === 'object' && k in result) {
                        result = result[k];
                    } else {
                        result = this.translations['default'];
                        for (const ek of keys) {
                            if (result && typeof result === 'object' && ek in result) {
                                result = result[ek];
                            } else {
                                return defaultValue;
                            }
                        }
                        break;
                    }
                }
                return result || defaultValue;
            },

            async setLanguage(lang) {
                if (!this.translations[lang]) {
                    await this.loadTranslations(lang);
                }
                this.currentLang = lang;
                localStorage.setItem('lang', lang);
                this.applyTranslations();
            },

            applyTranslations() {
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    const defaultValue = element.getAttribute('data-i18n-default') || '';
                    element.innerHTML = this.translate(key, defaultValue);
                });
            }
        };

        // å†…å®¹æ¸²æŸ“å™¨
        class ContentRenderer {
            constructor(container) {
                this.container = container;
            }

            renderBlock(block) {
                if (!block.enabled) return null;

                const section = document.createElement('div');
                section.className = 'section';
                section.id = `block-${block.id}`;
                section.style.marginBottom = '25px';

                const glassContainer = document.createElement('div');
                glassContainer.className = 'glass-container-apple';
                
                // åº”ç”¨è‡ªå®šä¹‰æ ·å¼
                if (block.styles) {
                    Object.assign(glassContainer.style, block.styles);
                }

                // æ¸²æŸ“æ ‡é¢˜
                if (block.title) {
                    const title = document.createElement('h3');
                    title.className = 'section-title';
                    title.textContent = block.title;
                    glassContainer.appendChild(title);
                }

                // æ ¹æ®ç±»å‹æ¸²æŸ“å†…å®¹
                switch (block.type) {
                    case 'header':
                        this.renderHeader(glassContainer, block.content);
                        section.style.cssText = 'display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 100vh; text-align: center;';
                        break;
                    case 'text':
                        this.renderText(glassContainer, block.content);
                        break;
                    case 'list':
                        this.renderList(glassContainer, block.content);
                        break;
                    case 'custom':
                        this.renderCustom(glassContainer, block.content);
                        break;
                }

                section.appendChild(glassContainer);
                return section;
            }

            renderHeader(container, content) {
                if (content.greeting) {
                    const greeting = document.createElement('p');
                    greeting.className = 'info-text';
                    greeting.textContent = content.greeting;
                    container.appendChild(greeting);
                }

                if (content.name) {
                    const name = document.createElement('p');
                    const nameSpan = document.createElement('strong');
                    nameSpan.className = 'highlight';
                    nameSpan.textContent = content.name;
                    name.appendChild(nameSpan);
                    container.appendChild(name);
                }

                if (content.subtitle) {
                    const subtitle = document.createElement('p');
                    subtitle.className = 'info-text';
                    subtitle.textContent = content.subtitle;
                    container.appendChild(subtitle);
                }
            }

            renderText(container, content) {
                const text = document.createElement('p');
                text.className = 'info-text';
                text.textContent = content.text;
                container.appendChild(text);
            }

            renderList(container, content) {
                const list = document.createElement('ul');
                content.items.forEach(item => {
                    const li = document.createElement('li');
                    li.className = 'info-text';
                    li.textContent = item;
                    list.appendChild(li);
                });
                container.appendChild(list);
            }

            renderCustom(container, content) {
                container.innerHTML += content.html;
            }

            renderAll() {
                this.container.innerHTML = '';

                // æ·»åŠ æ¨±èŠ±ç”»å¸ƒ
                const canvas = document.createElement('canvas');
                canvas.id = 'sakura-canvas';
                canvas.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1;';
                this.container.appendChild(canvas);

                // æ¸²æŸ“æ‰€æœ‰å¯ç”¨çš„å†…å®¹å—
                config.contentBlocks.forEach(block => {
                    if (block.enabled) {
                        const blockElement = this.renderBlock(block);
                        if (blockElement) {
                            this.container.appendChild(blockElement);
                        }
                    }
                });
            }
        }

        // å†…å®¹ç®¡ç†å™¨
        class ContentManager {
            constructor() {
                this.renderer = new ContentRenderer(document.getElementById('content-container'));
                this.init();
            }

            init() {
                this.bindEvents();
                this.loadSavedConfig();
                this.applyConfig();
                this.renderBlocksList();
                this.initI18n();
            }

            bindEvents() {
                // é¡µé¢è®¾ç½®äº‹ä»¶
                document.getElementById('page-title-input').addEventListener('input', (e) => {
                    config.pageInfo.title = e.target.value;
                    document.title = e.target.value;
                });

                document.getElementById('background-input').addEventListener('input', (e) => {
                    config.styles.backgroundImage = e.target.value;
                    this.applyStyles();
                });

                // é¢œè‰²è®¾ç½®äº‹ä»¶
                this.bindColorEvents('primary-color', 'primaryColor');
                this.bindColorEvents('highlight-color', 'highlightColor');
                this.bindColorEvents('text-color', 'infoTextColor');

                // é¢æ¿æ§åˆ¶
                document.getElementById('close-panel').addEventListener('click', () => {
                    document.getElementById('management-panel').classList.remove('show');
                });

                // è¯­è¨€åˆ‡æ¢
                document.getElementById('language-switcher').addEventListener('change', (e) => {
                    i18n.setLanguage(e.target.value);
                });
            }

            bindColorEvents(inputId, configKey) {
                const colorInput = document.getElementById(inputId);
                const textInput = document.getElementById(inputId + '-text');

                colorInput.addEventListener('input', (e) => {
                    const color = e.target.value;
                    config.styles[configKey] = color;
                    textInput.value = color;
                    this.applyStyles();
                });

                textInput.addEventListener('input', (e) => {
                    const color = e.target.value;
                    if (/^#[0-9A-F]{6}$/i.test(color)) {
                        config.styles[configKey] = color;
                        colorInput.value = color;
                        this.applyStyles();
                    }
                });
            }

            applyConfig() {
                // åº”ç”¨é¡µé¢æ ‡é¢˜
                document.title = config.pageInfo.title;
                document.getElementById('page-title-input').value = config.pageInfo.title;

                // åº”ç”¨èƒŒæ™¯
                document.getElementById('background-input').value = config.styles.backgroundImage;

                // åº”ç”¨é¢œè‰²
                document.getElementById('primary-color').value = config.styles.primaryColor;
                document.getElementById('primary-color-text').value = config.styles.primaryColor;
                document.getElementById('highlight-color').value = config.styles.highlightColor;
                document.getElementById('highlight-color-text').value = config.styles.highlightColor;
                document.getElementById('text-color').value = config.styles.infoTextColor;
                document.getElementById('text-color-text').value = config.styles.infoTextColor;

                this.applyStyles();
                this.renderer.renderAll();
            }

            applyStyles() {
                document.body.style.setProperty('--background-image', `url("${config.styles.backgroundImage}")`);
                document.documentElement.style.setProperty('--primary-color', config.styles.primaryColor);
                document.documentElement.style.setProperty('--highlight-color', config.styles.highlightColor);
                document.documentElement.style.setProperty('--info-text-color', config.styles.infoTextColor);
            }

            renderBlocksList() {
                const list = document.getElementById('blocks-list');
                list.innerHTML = '';

                config.contentBlocks.forEach((block, index) => {
                    const item = document.createElement('div');
                    item.className = 'block-item';
                    item.innerHTML = `
                        <div class="block-header">
                            <div>
                                <span class="drag-handle">â‹®â‹®</span>
                                <span class="block-title">${block.title}</span>
                                <span class="block-type">${block.type}</span>
                            </div>
                        </div>
                        <div class="block-controls">
                            <button class="btn btn-primary" onclick="contentManager.editBlock(${index})">ç¼–è¾‘</button>
                            <button class="btn ${block.enabled ? 'btn-warning' : 'btn-success'}" onclick="contentManager.toggleBlock(${index})">${block.enabled ? 'éšè—' : 'æ˜¾ç¤º'}</button>
                            <button class="btn btn-danger" onclick="contentManager.deleteBlock(${index})">åˆ é™¤</button>
                        </div>
                    `;
                    list.appendChild(item);
                });
            }

            editBlock(index) {
                const block = config.contentBlocks[index];
                const newTitle = prompt('ç¼–è¾‘æ ‡é¢˜:', block.title);
                if (newTitle !== null) block.title = newTitle;

                switch (block.type) {
                    case 'header':
                        const greeting = prompt('ç¼–è¾‘é—®å€™è¯­:', block.content.greeting);
                        const name = prompt('ç¼–è¾‘å§“å:', block.content.name);
                        const subtitle = prompt('ç¼–è¾‘å‰¯æ ‡é¢˜:', block.content.subtitle);
                        if (greeting !== null) block.content.greeting = greeting;
                        if (name !== null) block.content.name = name;
                        if (subtitle !== null) block.content.subtitle = subtitle;
                        break;
                    case 'text':
                        const text = prompt('ç¼–è¾‘æ–‡æœ¬:', block.content.text);
                        if (text !== null) block.content.text = text;
                        break;
                    case 'list':
                        const items = prompt('ç¼–è¾‘åˆ—è¡¨é¡¹ (ç”¨æ¢è¡Œåˆ†éš”):', block.content.items.join('\n'));
                        if (items !== null) block.content.items = items.split('\n').filter(item => item.trim());
                        break;
                    case 'custom':
                        const html = prompt('ç¼–è¾‘HTML:', block.content.html);
                        if (html !== null) block.content.html = html;
                        break;
                }

                this.applyConfig();
                this.renderBlocksList();
            }

            toggleBlock(index) {
                config.contentBlocks[index].enabled = !config.contentBlocks[index].enabled;
                this.applyConfig();
                this.renderBlocksList();
            }

            deleteBlock(index) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå†…å®¹å—å—ï¼Ÿ')) {
                    config.contentBlocks.splice(index, 1);
                    this.applyConfig();
                    this.renderBlocksList();
                }
            }

            loadSavedConfig() {
                const saved = localStorage.getItem('selfIntroConfig');
                if (saved) {
                    try {
                        const savedConfig = JSON.parse(saved);
                        Object.assign(config, savedConfig);
                    } catch (error) {
                        console.error('åŠ è½½ä¿å­˜çš„é…ç½®å¤±è´¥:', error);
                    }
                }
            }

            async initI18n() {
                const savedLang = localStorage.getItem('lang') || 'default';
                await i18n.loadTranslations('default');
                if (savedLang !== 'default') {
                    await i18n.loadTranslations(savedLang);
                }
                i18n.currentLang = savedLang;
                document.getElementById('language-switcher').value = savedLang;
                i18n.applyTranslations();
            }
        }

        // å…¨å±€å‡½æ•°
        function togglePanel() {
            document.getElementById('management-panel').classList.toggle('show');
        }

        function addBlock() {
            const type = document.getElementById('block-type').value;
            const title = document.getElementById('block-title').value || 'æ–°å†…å®¹å—';

            const newBlock = {
                id: 'block_' + Date.now(),
                type: type,
                enabled: true,
                title: title,
                content: getDefaultContent(type),
                styles: {
                    backgroundColor: "rgba(255, 255, 255, 0.1)",
                    padding: "20px",
                    borderRadius: "24px"
                }
            };

            config.contentBlocks.push(newBlock);
            contentManager.applyConfig();
            contentManager.renderBlocksList();
            document.getElementById('block-title').value = '';
        }

        function getDefaultContent(type) {
            switch (type) {
                case 'header':
                    return { greeting: "è¯·è¾“å…¥é—®å€™è¯­", name: "è¯·è¾“å…¥å§“å", subtitle: "è¯·è¾“å…¥å‰¯æ ‡é¢˜" };
                case 'text':
                    return { text: "è¯·è¾“å…¥æ–‡æœ¬å†…å®¹" };
                case 'list':
                    return { items: ["è¯·è¾“å…¥åˆ—è¡¨é¡¹1", "è¯·è¾“å…¥åˆ—è¡¨é¡¹2"] };
                case 'custom':
                    return { html: '<p class="info-text">è¯·è¾“å…¥è‡ªå®šä¹‰HTML</p>' };
                default:
                    return {};
            }
        }

        function saveConfig() {
            localStorage.setItem('selfIntroConfig', JSON.stringify(config));
            alert('é…ç½®å·²ä¿å­˜ï¼');
        }

        function exportConfig() {
            const dataStr = JSON.stringify(config, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'self-intro-config.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function importConfig(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedConfig = JSON.parse(e.target.result);
                    if (confirm('å¯¼å…¥é…ç½®å°†è¦†ç›–å½“å‰è®¾ç½®ï¼Œç¡®å®šç»§ç»­å—ï¼Ÿ')) {
                        Object.assign(config, importedConfig);
                        contentManager.applyConfig();
                        contentManager.renderBlocksList();
                        alert('é…ç½®å¯¼å…¥æˆåŠŸï¼');
                    }
                } catch (error) {
                    alert('é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼');
                }
            };
            reader.readAsText(file);
        }

        function resetConfig() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰é…ç½®å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰è‡ªå®šä¹‰å†…å®¹ã€‚')) {
                localStorage.removeItem('selfIntroConfig');
                location.reload();
            }
        }

        // åˆå§‹åŒ–
        let contentManager;
        document.addEventListener('DOMContentLoaded', () => {
            contentManager = new ContentManager();
        });
    </script>
</body>
</html>

